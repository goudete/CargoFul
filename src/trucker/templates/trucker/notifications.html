{% extends 'trucker/base.html'%}
{% load static %}
{% load i18n %}

{% block content %}
<!--styling to make table overflow scroll -->
<style>
  table tbody{
    height: 300px;
    overflow-y: auto;
  }
  table thead th{
    position: sticky;
    position: -webkit-sticky;
    top: 0;
    z-index: 5;
    background-color: white;
    color: black;
  }
</style>
<!-- messages end here -->

<!--start of counter offer table -->
<div class="row justify-content-center mt-5">
  <div class="col-md-8">
    <h3>{% trans "Counter Offer Updates" %}</h3>
  </div>
</div>

<div class="row justify-content-center pt-2" id = 'dashboard'>
  <div class="col-md-8">
    <div class="card">
    <table class="table table-striped">
      {% if counter_offers|length > 0 %}
      <thead>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <tr>
          <th scope = 'col'></th>
          <th scope = 'col'></th>
        </tr>
      </thead>
      <tbody>
        {% for c in counter_offers %}
        <tr>
          {% if c.status == 1 %}
          <td>{{ c.order.shipping_company.user.profile.company_name }} {% trans "has" %} <b style = "color: red">{% trans "denied" %}</b> {% trans "your counter offer on order" %} <b>{{ c.order.customer_order_no }}</b></td>
          {% else %}
          <td>{{ c.order.shipping_company.user.profile.company_name }} {% trans "has" %} <b style = "color: green">{% trans "accepted" %}</b> {% trans "your counter offer on order" %} <b>{{ c.order.customer_order_no }}</b></td>
          {% endif %}
          <td>
            <form action = 'read_counter_offer_notification' method = 'POST'>
              {% csrf_token %}
              <input type = 'number' name = 'counter_offer_id' value = {{c.id}} hidden = 'true'>
              <button type = 'submit' class = 'btn btn-success'>Ok</button> <!-- this button is for when you just want the notification to go away -->
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
      {% else %}
      <thead>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <tr>
          <th scope = 'col'></th>
        </tr>
      </thead>
      <tbody>
        <td align = "center"><h4><b>{% trans "No Updates" %}</b></h4></td>
      </tbody>
      {% endif %}
    </table>
    </div>
  </div>
</div>

<!-- start of new order notifications -->
<div class="row justify-content-center mt-5">
  <div class="col-md-8">
    <h3>{% trans "New Orders Posted" %}</h3>
  </div>
</div>

<!-- start of new orders table -->
<div class="row justify-content-center pt-2" id = 'dashboard'>
  <div class="col-md-8">
    <div class="card">
    <table class="table table-striped">
      {% if order_notifications|length > 0 %}
      <thead>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <tr>
          <th scope = 'col'></th>
          <th scope = 'col'></th>
        </tr>
      </thead>
      <tbody>
        {% for o in order_notifications %}
        <tr>
          <td>{{ o.order.shipping_company.user.profile.company_name }} {% trans "has posted a new order" %}</td>
          <td>
            <form action = 'read_show_order_notification' method = 'POST'>
              {% csrf_token %}
              <input type = 'number' name = 'notification_id' value = {{o.id}} hidden = 'true'>
              <input type = 'number' name = 'order_id' value = {{o.order.id}} hidden = 'true'>
              <button type = 'submit' class = 'btn btn-secondary'>{% trans "View Order" %}</button> <!-- this is for viewing the order -->
              <button type = 'submit' formaction = 'read_order_notification' class = 'btn btn-success'>Ok</button> <!-- this button is for when you just want the notification to go away -->
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
      {% else %}
      <thead>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <tr>
          <th scope = 'col'></th>
        </tr>
      </thead>
      <tbody>
        <td align = "center"><h4><b>{% trans "No New Orders Posted" %}</b></h4></td>
      </tbody>
      {% endif %}
    </table>
    </div>
  </div>
</div>

<!-- dash of connections -->
<div class="row justify-content-center mt-5">
  <div class="col-md-8">
    <h3>{% trans "Connection Requests" %}</h3>
  </div>
</div>

<!-- start of connections table -->
<div class="row justify-content-center pt-2" id = 'dashboard'>
  <div class="col-md-8">
    <div class="card">
    <table class="table table-striped">
      {% if requests|length > 0 %}
      <thead>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <tr>
          <th scope = 'col'>{% trans "Company Name" %}</th>
          <th scope = 'col'></th>
        </tr>
      </thead>
      <tbody>
        {% for r in requests %}
        <tr>
          <td>{{ r.from_user.profile.company_name }}</td>
          <td>
            <form action = 'accept_request' method = 'POST'>
              {% csrf_token %}
              <input type = 'number' name = 'request_id' value = {{r.id}} hidden = 'true'>
              <button type = 'submit' class = 'btn btn-success'>{% trans "Accept" %}</button>
              <button type = 'submit' formaction = 'deny_request' class = 'btn btn-danger'>{% trans "Decline" %}</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
      {% else %}
      <thead>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <tr>
          <th scope = 'col'></th>
        </tr>
      </thead>
      <tbody>
        <td align = "center"><h4><b>{% trans "No Connection Requests" %}</b></h4></td>
      </tbody>
      {% endif %}
    </table>
    </div>
  </div>
</div>
{% endblock %}
